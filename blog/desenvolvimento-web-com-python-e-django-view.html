<!DOCTYPE html>
<html lang="pt-br">
	<head>		
				<!-- Global site tag (gtag.js) - Google Analytics -->
					
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116930343-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116930343-1');
</script>
			
		<!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '315628773120375');
    fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=315628773120375&ev=PageView&noscript=1"/></noscript>
<!-- End Facebook Pixel Code -->
		

		<meta charset="utf-8">
		<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">		

		<title>A Camada View do framework de desenvolvimento web Django (Python)</title>
		<link rel="icon" type="image/png" href="/assets/img/favicon.png">		

		<!-- Robots -->
				
		<meta name="robots" content="index, follow">
		
		
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" integrity="sha512-1cK78a1o+ht2JcaW6g8OXYwqpev9+6GqOkz9xmBN9iUUhIndKtxwILGWYOSibOKjLsEdjyjZvYDq/cZwNeak0w==" crossorigin="anonymous" />

		<!-- Assets -->
		<link rel="stylesheet" href="/assets/css/master.css"/>			

		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Lato:100,300,400,700|Montserrat:400,700|Droid+Serif:400,700,400italic,700italic|Raleway:100,200,300,400,500,600,700,800|Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800|Merriweather:400,300,300italic,400italic,700,700italic,900,900italic|Space+Mono:400,700|Inconsolata:400,700|Muli:200,300,400,600,700|Quicksand:300,400,500,700|Source+Serif+Pro:400,700|Roboto+Condensed:300,400,700|Roboto:300,400,500,700|Ubuntu:300,400,500,700|Oswald:300,400,500,600" rel="stylesheet">

		<!-- Canonical URL -->
		<link rel="canonical" href="https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-view">	

		
		
		
		
		
		
		
		
		
				

				
		<!-- General -->
		<meta name="description" content="Nesse post, vamos tratar da camada View do Django. Nela, nós desenvolvemos a lógica de negócio da nossa aplicação. Vamos ver sobre rotas, processamento de requisições e respostas, utilização de formulários e muito mais!">		
		<meta name="title" content="A Camada View do framework de desenvolvimento web Django (Python)">
		<meta itemprop="image" content="https://pythonacademy.com.br/assets/posts/django-view/facebook.png">

		<!-- Open Graph -->
		<meta property="fb:app_id" content="220280761884954">
		<meta property="og:site_name" content="Python Academy">
		<meta property="og:type" content="website">
		<meta property="og:title" content="A Camada View do framework de desenvolvimento web Django (Python)">
		<meta property="og:url" content="https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-view">
		<meta property="og:description" content="Nesse post, vamos tratar da camada View do Django. Nela, nós desenvolvemos a lógica de negócio da nossa aplicação. Vamos ver sobre rotas, processamento de requisições e respostas, utilização de formulários e muito mais!">
		<meta property="og:image" itemprop="image" content="https://pythonacademy.com.br/assets/posts/django-view/facebook.png" />
		<meta property="og:image:alt" content="A Camada View do framework de desenvolvimento web Django (Python)" />
		<meta property="og:image:type" content="image/png" />
		<meta property="og:image:width" content="1200" />
		<meta property="og:image:height" content="630" />

		<!-- Twitter cards -->
		<meta name="twitter:card" content="summary">
		<meta name="twitter:site" content="@https://twitter.com/PythonAcademyBR">
		<meta name="twitter:title" content="A Camada View do framework de desenvolvimento web Django (Python)">
		<meta name="twitter:description" content="Nesse post, vamos tratar da camada View do Django. Nela, nós desenvolvemos a lógica de negócio da nossa aplicação. Vamos ver sobre rotas, processamento de requisições e respostas, utilização de formulários e muito mais!">
		<meta name="twitter:image:src" content="https://pythonacademy.com.br/assets/posts/django-view/twitter.png">
		
		<meta name="twitter:creator" content="@https://twitter.com/PythonAcademyBR">
		
		

		<link rel="stylesheet" href="/assets/css/post.css?1614395678891571978">
	</head>

	<body id="post-body">		
		


<header class="header">
	
	<nav class="navbar navbar-default">
		<div class="container">
	
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed " onclick="showMenu()" onblur="hideMenu()" data-toggle="collapse" data-target="#main-menu" aria-expanded="true">
					<span class="sr-only">Habilitar navegação</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>

				<a class="navbar-brand" rel="home" href="https://pythonacademy.com.br">
					<img alt="Python Academy" src="/assets/img/logo.png">
				</a>
			</div>

			<div id="main-menu" class="collapse navbar-collapse">
				<ul class="nav navbar-nav navbar-right">
					<li>
						<a href="https://pythonacademy.com.br" title="Volte à página inicial">
							Início
						</a>
					</li>
					
					<li>
						<a href="https://pythonacademy.com.br/blog/" title="Aprenda com nossos artigos">
							Blog
						</a>
					</li>						
					
					<li>
						<a href="https://pythonacademy.com.br/sliders/" title="Aprenda na prática">
							Sliders
						</a>
					</li>						

					<li>
						<a href="https://pythonacademy.com.br/sobre" title="Conheça-nos">
							Sobre
						</a>
					</li>						
				</ul>
			</div>
		</div>
	</nav>
</header>	

		<a href="#" class="sticky-newsletter hidden-xs" data-toggle="modal" data-target="#email-modal">
    <div class="rotate-text">
        <span>Receba todas as novidades!</span>
    </div>
</a>

<!-- Include email modal form with text, input and submit button to acquire emails to our list -->
<!-- Parameters: email-modal = modal id  -->

<div class="modal fade email-modal" id="email-modal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">                                    
            <div class="modal-body text-center">
                <a href="#" data-dismiss="modal" aria-label="Close" class="pull-right close-icon"><i class="fa fa-times" aria-hidden="true"></i></a>
                <h3 class="modal-title">Seja o primeiro a receber o melhor conteúdo!</h3>
                <div class="modal-label">
                    <p class="email-label">Cadastre o seu melhor email para <strong>receber gratuitamente <br></strong><strong>conteúdos exclusivos</strong> e muito mais!</p>
                </div>
                <!--<i class="down-icon fa fa-arrow-down fa-fw" aria-hidden="true"></i>-->

                <div class="mailchimp-input">
                    <!-- Include MailChimp email form with input and submit button -->
<!-- Parameters: QUERO RECEBER = button label  -->

<form action="https://pythonacademy.us12.list-manage.com/subscribe/post?u=d818a1dcab21e0bb6fbe4a39b&amp;id=11b4623db6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" autocomplete="off" novalidate>
    <div id="mc_embed_signup_scroll" class="container-fluid">        
        <div class="row no-gutters">
            <div class="col-xs-3">
                <input id="mce-NAME" type="text" value="" name="NAME" class="signup-input name" placeholder="Nome" required>
            </div>
            
            <div class="col-xs-5">                
                <input id="mce-EMAIL" type="email" value="" name="EMAIL" class="signup-input email" placeholder="Email" required>                
            </div>

            <div class="col-xs-4">
                <button id="mc-embedded-subscribe" type="submit" name="subscribe" class="btn">
                    <!--<i class="fa fa-paper-plane-o fa-fw" aria-hidden="true"></i>-->
                    <!--<span>Enviar</span>-->
                    <i class="fa fa-mail-forward visible-xs" aria-hidden="true"></i>
                    <span class="hidden-xs"><img class="emoji" title=":rocket:" alt=":rocket:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f680.png" height="20" width="20"> QUERO RECEBER</span>
                </button>        
            </div>
        </div>
    </div>	

    <div id="mce-responses" class="clear">
        <div class="response" id="mce-error-response" style="display:none"></div>
        <div class="response" id="mce-success-response" style="display:none"></div>
    </div>            
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_d818a1dcab21e0bb6fbe4a39b_11b4623db6" tabindex="-1" value=""></div>
</form>
                </div>                

                <p class="pos-input text-center" style="font-size: 70%; margin-top: 10px; margin-bottom: 10px;">Não se preocupe, respeitamos sua privacidade. Você pode se descadastrar a qualquer momento.</p>
            </div>
        </div>
    </div>
</div>



		<div class="main-container" data-aos="fade-in" data-aos-duration="1500">
			<section class="post-banner">	
				<div class="post-banner-wrapper">
					<div class="post-banner-content" style="background: #051a12 url('/assets/svg/stars-bground.svg');">
						<div class="container">	
							<div class="wrapper">
								<div class="featured-icon-wrapper">
									<object id="featured-icon" class="featured-icon" type="image/svg+xml" data="/assets/posts/django-view/featured_icon.svg" width="90%">
									</object>															
								</div>
							</div>													
			
							
							<h1 class="blog-post-title font-shadow">
								Desenvolvimento Web com Python e Django: View
							</h1>			
						</div>			
					</div>
				</div>
			</section>	
			
			<div class="post-meta">
				<div class="container">
					<div class="post-meta-wrapper">
						<div class="row">
							<div class="col-xs-12 col-sm-6 col-sm-offset-3">
								<div class="col-xs-6">
									<div class="post-meta-data">
										<img src="/assets/svg/clock.svg" alt="Tempo de Leitura">
										<span>15 min.</span>
									</div>
								</div>

								<div class="col-xs-6">
									<div class="post-meta-data">
										<img src="/assets/svg/level.svg" alt="Nível do Conteúdo">
										<span>Básico</span>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="container post-container">
				<div class="blog-post-content">
					
<p>Continuando a nossa série de <em>posts</em> sobre Django, no artigo de hoje vamos tratar sobre a camada <em>View</em> da sua arquitetura!</p>

<p>Se você ainda não leu os primeiros <em>posts</em> da série, você <strong>COM CERTEZA</strong> está perdendo informações importantes.</p>

<p>Se esse for o seu caso, então já <a href="https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-introducao" target="_blank">clica aqui pra ver o <em>post</em> introdutório</a> e/ou <a href="https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-model" target="_blank">aqui para ler o <em>post</em> sobre a camada <em>Model</em></a> e <strong>fique por dentro</strong>!</p>

<p>Agora, faça uma <strong>xícara de café</strong>, ajuste sua cadeira e vamos nessa que o <em>post</em> de hoje tá <strong>COMPLETÃO</strong>!!</p>

<p><img class="emoji" title=":coffee:" alt=":coffee:" src="https://github.githubassets.com/images/icons/emoji/unicode/2615.png" height="20" width="20"> <img class="emoji" title=":coffee:" alt=":coffee:" src="https://github.githubassets.com/images/icons/emoji/unicode/2615.png" height="20" width="20"> <img class="emoji" title=":coffee:" alt=":coffee:" src="https://github.githubassets.com/images/icons/emoji/unicode/2615.png" height="20" width="20"></p>

<h2 class="no_toc" id="vá-direto-ao-assunto">Vá Direto ao Assunto…</h2>

<ul id="markdown-toc">
  <li><a href="#onde-estamos" id="markdown-toc-onde-estamos">Onde estamos…</a></li>
  <li><a href="#detalhes-da-camada" id="markdown-toc-detalhes-da-camada">Detalhes da Camada</a></li>
  <li><a href="#fun%C3%A7%C3%B5es-vs-class-based-views" id="markdown-toc-funções-vs-class-based-views">Funções vs <em>Class Based Views</em></a></li>
  <li><a href="#fun%C3%A7%C3%B5es-function-based-views" id="markdown-toc-funções-function-based-views">Funções (<em>Function Based Views</em>)</a></li>
  <li><a href="#classes-cbv---class-based-views" id="markdown-toc-classes-cbv---class-based-views">Classes (CBV - <em>Class Based Views</em>)</a></li>
  <li><a href="#forms" id="markdown-toc-forms">Forms</a></li>
  <li><a href="#middlewares" id="markdown-toc-middlewares"><em>Middlewares</em></a></li>
</ul>

<h2 id="onde-estamos">Onde estamos…</h2>

<p>Primeiramente, vamos nos situar:</p>

<p><img src="/assets/posts/django-view/django-architecture.png" alt="Arquitetura do Django - Model" class="img-responsive"></p>

<p>No <a href="https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-introducao" target="_blank">primeiro post</a>, tratamos da parte introdutória do Django, uma visão geral das suas camadas, 
a instalacão do <em>framework</em> e (<strong>CLARO</strong>) a criação do famoso <strong><em>Hello World</em></strong> <em>Django-based</em>.</p>

<p>Já no <a href="https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-model" target="_blank">segundo post</a>, tratamos da camada <em>Model</em>, onde definimos as entidades do nosso sistema, a interface com o banco de dados e aprendemos como utilizar a API de acesso a dados provida pelo Django - que facilita muito nossa vida!</p>

<p>No <em>post</em> sobre a Camada <em>Model</em> desenvolvemos a base do nosso <em>HelloWorld</em>: um projeto de gerenciamento de funcionários.</p>

<p>Vamos continuar desenvolvendo-o nesse <em>post</em>, portanto, se você não tem o código desenvolvido, <a href="/assets/posts/django-view/helloworld.zip" target="_blank">baixe-o aqui</a> pois iremos utilizá-lo com o base!</p>

<p>Ao final do <em>post</em> se encontra o código final com o que foi passado aqui! <img class="emoji" title=":wink:" alt=":wink:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f609.png" height="20" width="20"></p>

<p>Agora, vamos um pouco mais fundo no Django e vamos tratar da camada <em>View</em> da arquitetura <strong>MTV</strong> do Django (<em>Model Template View</em>).</p>

<p>É nessa camada que descrevemos a <strong>lógica de negócio</strong> da nossa aplicação!</p>

<p>Sem mais delongas, apresento-lhes: <strong>A camada <em>View</em></strong>!</p>

<h2 id="detalhes-da-camada">Detalhes da Camada</h2>

<p>Essa camada tem a responsabilidade de processar as <strong>requisições</strong> vindas dos usuários, formar uma <strong>resposta</strong> e enviá-la de volta ao usuário. É aqui que residem nossas <strong>lógicas de negócio</strong>!</p>

<p>Ou seja, essa camada deve: <strong>recepcionar</strong>, <strong>processar</strong> e <strong>responder</strong>!</p>

<p>Para isso, começamos pelo <strong>roteamento de URLs</strong>!</p>

<p>A partir da URL que o usuário quer acessar (<code class="highlighter-rouge">/funcionarios</code>, por exemplo), o Django irá rotear a requisicão para quem irá tratá-la.</p>

<p>Mas primeiro, o Django precisa ser informado para <strong>onde</strong> mandar a requisição.</p>

<p>Fazemos isso no chamado <strong>URLconf</strong> e damos o nome à esse arquivo, por convenção, de <code class="highlighter-rouge">urls.py</code>!</p>

<p>Geralmente, temos um arquivo de rotas por <em>app</em> do Django. Portanto, crie um arquivo <code class="highlighter-rouge">urls.py</code> dentro da pasta <code class="highlighter-rouge">/helloworld</code> e outro na pasta <code class="highlighter-rouge">/website</code>.</p>

<p>Como o <em>app helloworld</em> é o núcleo da nossa aplicação, ele faz o papel de centralizador de rotas, isto é:</p>

<ul>
  <li>Primeiro, a requisição cai no arquivo <code class="highlighter-rouge">/helloworld/urls.py</code> e é roteada para o <em>app</em> correspondente.</li>
  <li>Em seguida, o URLConf do <em>app</em> (<code class="highlighter-rouge">/website/urls.py</code>, no nosso caso) vai rotear a requisição para a <em>view</em> que irá processar dada requisição.</li>
</ul>

<p>Dessa forma, o arquivo <code class="highlighter-rouge">helloworld/urls.py</code> deve conter:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django.urls.conf</span> <span class="kn">import</span> <span class="n">include</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># URL padrão
</span>    <span class="n">path</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">'website.urls'</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s">'website'</span><span class="p">)),</span>

    <span class="c1"># Interface administrativa
</span>    <span class="n">path</span><span class="p">(</span><span class="s">'admin/'</span><span class="p">,</span> <span class="n">admin</span><span class="p">.</span><span class="n">site</span><span class="p">.</span><span class="n">urls</span><span class="p">),</span>
<span class="p">]</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Assim, toda requisição sem o caminho (<em>path</em>) <code class="highlighter-rouge">/admin</code> vai ser roteado pela primeira regra: <code class="highlighter-rouge">website.urls</code> (URLConf do <em>app website</em>).</p>

<p>Em seguida, a requisição segue para o roteamento do <em>app</em> específico (<code class="highlighter-rouge">website</code>, no caso).</p>

<p><em>Pode parecer complicado, mas ali embaixo, quando tratarmos mais sobre Views, vai fazer mais sentido (se não fizer, poste sua dúvida aqui embaixo)!</em></p>

<p>A configuração do URLConf é bem simples! Basta definirmos qual função ou <code class="highlighter-rouge">View</code> irá processar requisições de <strong>tal</strong> URL.</p>

<p>Por exemplo, queremos que:</p>

<blockquote>
  <p><em>Quando um usuário acesse a URL raíz <code class="highlighter-rouge">/</code>, o Django chame a função <code class="highlighter-rouge">index()</code> para processar tal requisição</em></p>
</blockquote>

<p>Vejamos como poderíamos configurar esse roteamento no nosso arquivo <code class="highlighter-rouge">urls.py</code>:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td>
<td class="code"><pre><span class="c1"># Importamos a função index() definida no arquivo views.py
</span><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">app_name</span> <span class="o">=</span> <span class="s">'website'</span>

<span class="c1"># urlpatterns a lista de roteamentos de URLs para funções/Views
</span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># GET /
</span>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s">'^$'</span><span class="p">,</span> <span class="n">views</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'index'</span><span class="p">),</span>
<span class="p">]</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p><em>O atributo <code class="highlighter-rouge">app_name = 'website'</code> define o namespace do app <strong>website</strong> (lembre-se do décimo nono Zen do Python: <strong>namespaces</strong> são uma boa ideia! - <a href="https://pythonacademy.com.br/zen-of-python" target="_blank">clique aqui para saber mais sobre o Zen do Python</a>)</em></p>

<p>Django utilizava <strong>Expressões Regulares</strong> (RegEx - <em>Regular Expressions</em>) para o “casamento” de URLs.</p>

<p>Já na versão 2.0 do Django, os desenvolvedores retiraram a obrigatoriedade de se utilizar RegEx!!! Agora, ao invés de fazermos isso:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
</pre></td>
<td class="code"><pre><span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s">'^funcionarios/(?P&lt;ano&gt;[0-9]{4})/$'</span><span class="p">,</span> <span class="n">views</span><span class="p">.</span><span class="n">funcionarios_por_ano</span><span class="p">),</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>podemos fazer apenas:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
</pre></td>
<td class="code"><pre><span class="n">path</span><span class="p">(</span><span class="s">'funcionarios/&lt;int:ano&gt;/'</span><span class="p">,</span> <span class="n">views</span><span class="p">.</span><span class="n">funcionarios_por_ano</span><span class="p">),</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p><em><strong>Mais legível, né?!</strong></em></p>

<h2 id="funções-vs-class-based-views">Funções vs <em>Class Based Views</em>
</h2>

<p>Com as URLs corretamente configuradas, o Django irá rotear a sua requisição para onde você definiu. No caso acima, sua requisição irá cair na função <code class="highlighter-rouge">views.funcionarios_por_ano()</code>.</p>

<p>Podemos tratar as requisições de duas formas: através de funções ou através de <em>Class Based Views</em> (<strong>CBVs</strong> - ou apenas <em>Views</em>).</p>

<p>Utilizando <strong>funções</strong>, você basicamente vai definir uma função que recebe como parâmetro uma requisição (<code class="highlighter-rouge">request</code>), realizar algum processamento e retornar alguma informação.</p>

<p>Já as <em>Views</em> são classes que herdam de <code class="highlighter-rouge">django.views.generic.base.View</code> e que agrupam diversas funcionalidades e facilitam a vida do desenvolvedor.</p>

<p>Nós podemos herdar e estender as funcionalidades das <em>Views</em> do Django para atender a lógica da nossa aplicação.</p>

<p>Por exemplo, suponha você quer criar uma tela com a <strong>lista de todos os funcionários</strong>.</p>

<p>Utilizando <strong>funções</strong>, você poderia fazer da seguinte forma:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td>
<td class="code"><pre><span class="k">def</span> <span class="nf">lista_funcionarios</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="c1"># Primeiro, buscamos os funcionarios
</span>    <span class="n">funcionarios</span> <span class="o">=</span> <span class="n">Funcionario</span><span class="p">.</span><span class="n">objetos</span><span class="p">.</span><span class="nb">all</span><span class="p">()</span>

    <span class="c1"># Incluímos no contexto
</span>    <span class="n">contexto</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s">'funcionarios'</span><span class="p">:</span> <span class="n">funcionarios</span>
    <span class="p">}</span>

    <span class="c1"># Retornamos o template no qual os funcionários serão dispostos
</span>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"templates/funcionarios.html"</span><span class="p">,</span> <span class="n">contexto</span><span class="p">)</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Algumas colocações:</p>

<ul>
  <li>Toda função que vai processar requisições no Django recebe como primeiro parâmetro, um objeto <code class="highlighter-rouge">request</code> contendo os dados dessa requisição.</li>
  <li>Contexto é o conjunto de dados que estarão disponíveis no <em>template</em>.</li>
  <li>A função <code class="highlighter-rouge">django.shortcuts.render()</code> é um atalho (<em>shortcut</em>) do próprio Django que facilita a renderização de <em>templates</em>: ela recebe a própria requisição, o diretório do <em>template</em> e o contexto.</li>
</ul>

<p>Já utilizando <em>Views</em>, podemos utilizar a <em>View</em> <code class="highlighter-rouge">django.views.generic.ListView</code> para listar os funcionários, da seguinte forma:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="kn">import</span> <span class="n">ListView</span>

<span class="k">class</span> <span class="nc">ListaFuncionarios</span><span class="p">(</span><span class="n">ListView</span><span class="p">):</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s">"templates/funcionarios.html"</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Funcionario</span>
    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s">"funcionarios"</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p><em>Perceba que você não precisou descrever a lógica para buscar a lista de funcionários?</em></p>

<p>É <strong>exatamente isso</strong> que as <code class="highlighter-rouge">Views</code> do Django proporcionam: elas descrevem o comportamento padrão para as funcionalidades mais simples (listagem, exclusão, busca simples, atualização).</p>

<p>O caso comum para uma listagem de objetos é buscar todo o conjunto de dados daquela entidade e mostrar no template, certo?! É exatamento <strong>isso</strong> que a <code class="highlighter-rouge">ListView</code> faz!</p>

<p>Com isso, um objeto <code class="highlighter-rouge">funcionarios</code> estará disponível, <strong>magicamente</strong>, no seu <em>template</em> para iteração.</p>

<p>Dessa forma, podemos então criar uma tabela no nosso <em>template</em> com os dados de todos os funcionários:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td>
<td class="code"><pre><span class="nt">&lt;table&gt;</span>
  <span class="nt">&lt;tbody&gt;</span>
    {% for funcionario in funcionarios %}
      <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;td&gt;</span>{{ funcionario.nome }}<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td&gt;</span>{{ funcionario.sobrenome }}<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td&gt;</span>{{ funcionario.remuneracao }}<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td&gt;</span>{{ funcionario.tempo_de_servico }}<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;/tr&gt;</span>
    {% endfor %}
  <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p><em>Se já quiser saber mais sobre <strong>templates</strong>, <a href="https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-template">acesse aqui o post sobre a Camada de Templates</a>!</em></p>

<p>Falando nisso, que tal fazer parte da nossa comunidade e saber do lançamento dos próximos <em>posts</em> e <strong>muito mais</strong> em primeira mão?!</p>

<p><strong>Então já se inscreve aí!</strong></p>

<div class="email-signup" data-aos="fade-up" data-aos-easing="ease-out-quart" data-aos-duration="650">
	<div class="row">
		<div class="col-xs-12">
			<div class="signup-body">
				<span class="greeting">Olá <img class="emoji" title=":wave:" alt=":wave:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f44b.png" height="20" width="20"> Está gostando do artigo?</span>
				<span class="signup-text">Então cadastre o seu email para <span class="underline">receber gratuitamente</span> mais conteúdos como este!</span>
		        <!-- Include MailChimp email form with input and submit button -->
<!-- Parameters: Quero ser um PYTHONISTA = button label  -->

<form action="https://pythonacademy.us12.list-manage.com/subscribe/post?u=d818a1dcab21e0bb6fbe4a39b&amp;id=11b4623db6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" autocomplete="off" novalidate="">
    <div id="mc_embed_signup_scroll" class="container-fluid">        
        <div class="row no-gutters">
            <div class="col-xs-3">
                <input id="mce-NAME" type="text" value="" name="NAME" class="signup-input name" placeholder="Nome" required="">
            </div>
            
            <div class="col-xs-5">                
                <input id="mce-EMAIL" type="email" value="" name="EMAIL" class="signup-input email" placeholder="Email" required="">                
            </div>

            <div class="col-xs-4">
                <button id="mc-embedded-subscribe" type="submit" name="subscribe" class="btn">
                    <!--<i class="fa fa-paper-plane-o fa-fw" aria-hidden="true"></i>-->
                    <!--<span>Enviar</span>-->
                    <i class="fa fa-mail-forward visible-xs" aria-hidden="true"></i>
                    <span class="hidden-xs"><img class="emoji" title=":rocket:" alt=":rocket:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f680.png" height="20" width="20"> Quero ser um PYTHONISTA</span>
                </button>        
            </div>
        </div>
    </div>	

    <div id="mce-responses" class="clear">
        <div class="response" id="mce-error-response" style="display:none"></div>
        <div class="response" id="mce-success-response" style="display:none"></div>
    </div>            
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_d818a1dcab21e0bb6fbe4a39b_11b4623db6" tabindex="-1" value=""></div>
</form>
		    </div>
		</div>
	</div>      
</div>

<p>Continuando…</p>

<p>O Django tem uma diversidade enorme de <em>Views</em>, uma para cada finalidade, por exemplo:</p>

<ul>
  <li>
<code class="highlighter-rouge">CreateView</code>: Facilita a criação de objetos (<em>É o <strong>C</strong>reate do <strong>C</strong>RUD</em>)</li>
  <li>
<code class="highlighter-rouge">DetailView</code>: Traz os detalhes de um objeto (<em>É o <strong>R</strong>etrieve do C<strong>R</strong>UD</em>)</li>
  <li>
<code class="highlighter-rouge">UpdateView</code>: Facilita a atualização de um objeto (<em>É o <strong>U</strong>pdate do CR<strong>U</strong>D</em>)</li>
  <li>
<code class="highlighter-rouge">DeleteView</code>: Facilita a deleção de objetos (<em>É o <strong>D</strong>elete do CRU<strong>D</strong></em>)</li>
</ul>

<p>E várias outras muito úteis!</p>

<p>Agora vamos tratar detalhes do tratamento de requisições através de funções. Em seguida, trataremos mais sobre as <em>Class Based Views</em>.</p>

<h2 id="funções-function-based-views">Funções (<em>Function Based Views</em>)</h2>

<p>Utilizar funções é a maneira mais explícita para tratar requisições no Django (veremos que as <em>Class Based Views</em> podem ser 
um pouco mais complexas pois muita coisa acontece implicitamente).</p>

<p>Utilizando funções, geralmente tratamos primeiro o método HTTP da requisição: foi um <code class="highlighter-rouge">GET</code>? Foi um <code class="highlighter-rouge">POST</code>? Um <code class="highlighter-rouge">OPTION</code>?</p>

<p>A partir dessa informação, processamos a requisição da maneira desejada.</p>

<p>Vamos seguir o exemplo abaixo:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td>
<td class="code"><pre><span class="k">def</span> <span class="nf">cria_funcionario</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
  <span class="c1"># Verificamos se o método POST
</span>  <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">'POST'</span><span class="p">:</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">FormularioDeCriacao</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">POST</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">form</span><span class="p">.</span><span class="n">is_valid</span><span class="p">():</span>
      <span class="n">form</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>      
      <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'list_view'</span><span class="p">))</span>
  
  <span class="c1"># Qualquer outro método: GET, OPTION, DELETE, etc...
</span>  <span class="k">else</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">templates</span><span class="o">/</span><span class="n">form</span><span class="p">.</span><span class="n">html</span><span class="p">,</span> <span class="p">{</span><span class="s">'form'</span><span class="p">:</span> <span class="n">form</span><span class="p">})</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>O fluxo é bem simples de entender, vamos lá:</p>

<ul>
  <li>Primeiro, conforme mencionei, verificamos o método HTTP da requisição no campo <code class="highlighter-rouge">method</code> do objeto <code class="highlighter-rouge">request</code> na <strong>linha 3</strong>.</li>
  <li>Depois instanciamos um <code class="highlighter-rouge">form</code> com os dados da requisição (no caso <code class="highlighter-rouge">POST</code>) com <code class="highlighter-rouge">FormularioDeCriacao(request.POST)</code> na <strong>linha 4</strong> (vamos falar mais sobre <code class="highlighter-rouge">Form</code> já já).</li>
  <li>Verificamos os campos do <code class="highlighter-rouge">form</code> com <code class="highlighter-rouge">form.is_valid()</code> na <strong>linha 6</strong>..</li>
  <li>Se tudo estiver <strong>OK</strong>, retornamos um <em>redirect</em> para uma <em>view</em> de listagem na <strong>linha 8</strong>.</li>
  <li>Se for qualquer outro método, apenas renderizamos a página novamente com <code class="highlighter-rouge">render(request, templates/form.html, {'form': form})</code> na <strong>linha 12</strong>.</li>
</ul>

<p>Apesar de ser pouco código, foram introduzidos diversos conceitos novos. Então vamos por partes!</p>

<p>Vamos começar abrindo o objeto <code class="highlighter-rouge">request</code> para ver o que tem dentro e ver o que pode ser útil para nós.</p>

<p><strong><em>Observação</em></strong>: <em>Para saber mais sobre os campos do objeto <code class="highlighter-rouge">request</code>, dá uma olhada na classe <code class="highlighter-rouge">django.http.request.HttpRequest</code></em>!</p>

<p>Separei aqui alguns atributos que provavelmente serão os mais utilizados por você:</p>

<ul>
  <li>
<code class="highlighter-rouge">request.scheme</code>: String representando o esquema (<em>HTTP</em> ou <em>HTTPS</em>).</li>
  <li>
<code class="highlighter-rouge">request.path</code>: String com o caminho da página requisitada - exemplo: <strong>/cursos/curso-de-python/detalhes</strong>.</li>
  <li>
<code class="highlighter-rouge">request.method</code>: Conforme citamos, contém o método <em>HTTP</em> da requisição (<strong>GET</strong>, <strong>POST</strong>, <strong>UPDATE</strong>, <strong>OPTION</strong>, etc).</li>
  <li>
<code class="highlighter-rouge">request.content_type</code>: Representa o tipo MIME da requisição - <code class="highlighter-rouge">text/plain</code> para texto plano, <code class="highlighter-rouge">image/png</code> para arquivos .PNG, por exemplo - saiba mais <a href="https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Basico_sobre_HTTP/MIME_types" target="_blank">clicando aqui</a>
</li>
  <li>
<code class="highlighter-rouge">request.GET</code>: Um <em>dict</em> contendo os parâmetros GET da requisição.</li>
  <li>
<code class="highlighter-rouge">request.POST</code>: Um <em>dict</em> contendo os parâmetros do corpo de uma requisição POST.</li>
  <li>
<code class="highlighter-rouge">request.FILES</code>: Caso seja uma página de <em>upload</em>, contém os arquivos que foram enviados. Só contém dados se for uma requisição do tipo <em>POST</em> e o <code class="highlighter-rouge">&lt;form&gt;</code> da página <em>HTML</em> tenha o parâmetro <code class="highlighter-rouge">enctype="multipart/form-data"</code>.</li>
  <li>
<code class="highlighter-rouge">request.COOKIES</code>: <em>Dict</em> contendo todos os <em>COOKIES</em> no formato de string.</li>
</ul>

<p>Em 99.9% dos casos, estaremos processando dados desses campos!</p>

<p><em><strong>Dica:</strong> Quer ver os campos da requisição em “tempo real” que chegaram no servidor? Então liga o debug da sua IDE (caso tenha) e coloque um breakpoint em alguma view, dispare alguma requisição e veja o que acontece! Por exemplo, utilizando o PyCharm:</em></p>

<p><img src="/assets/posts/django-view/debug.png" alt="Debugando com o PyCharm" class="img-responsive"></p>

<p><em>(Caso esteja ruim de ver a imagem, clique com o botão direito em cima da imagem e depois em “Abrir imagem em uma nova guia”).</em></p>

<p><em>Do <strong>lado esquerdo</strong>, o código com o breakpoint que coloquei (círculo vermelho). Do <strong>lado direito</strong>, as variáveis do objeto <code class="highlighter-rouge">request</code> que tratamos aqui em cima!</em></p>

<p><em><strong>Outra dica</strong>: Recomendo fortemente a utilização do PyCharm! Ela é MUITO boa!</em></p>

<p>Dito isso, agora vamos tratar detalhes do tratamento de requisições através de <em>Class Based Views</em>.</p>

<h2 id="classes-cbv---class-based-views">Classes (CBV - <em>Class Based Views</em>)</h2>

<p>Conforme expliquei ali em cima, as <em>Class Based Views</em> servem para automatizar e facilitar nossa vida, encapsulando funcionalidades comuns que todo desenvolvedor sempre acaba implementando. Por exemplo, geralmente:</p>

<ul>
  <li>Queremos que quando um usuário vá para página inicial, seja mostrado <strong>apenas uma página</strong> simples.</li>
  <li>Queremos que nossa <strong>página de listagem</strong> contenha a <strong>lista</strong> de todos os funcionários (por exemplo) cadastrados no banco de dados.</li>
  <li>Queremos uma <strong>página com um formulário</strong> contendo todos os campos pré-preenchidos para <strong>atualização</strong> de dado funcionário.</li>
  <li>Queremos uma <strong>página de exclusão</strong> de funcionários.</li>
  <li>Queremos um formulário em branco para <strong>inclusão de um novo funcionário</strong>.</li>
</ul>

<p><strong><em>Certo?!</em></strong></p>

<p>Pois é, as <strong>CBVs</strong> - <em>Class Based Views</em> - fazem isso!</p>

<p>Temos basicamente <strong>duas formas</strong> para utilizar uma <strong>CBV</strong>.</p>

<p>Primeiro, podemos utilizá-las diretamente no nosso <strong>URLConf</strong> (urls.py), assim:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="kn">import</span> <span class="n">TemplateView</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">TemplateView</span><span class="p">.</span><span class="n">as_view</span><span class="p">(</span><span class="n">template_name</span><span class="o">=</span><span class="s">"index.html"</span><span class="p">)),</span>
<span class="p">]</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>E a segunda maneira, a mais utilizada e mais poderosa, é herdando da <em>View</em> desejada e sobrescrever os atributos e métodos na subclasse.</p>

<p><em>Eu particularmente prefiro a segunda forma, pois encapsula todas as Views no mesmo arquivo: no views.py</em></p>

<h3 id="templateview"><code class="highlighter-rouge">TemplateView</code></h3>

<p>Por exemplo, para o <strong>primeiro caso</strong>, podemos utilizar a <code class="highlighter-rouge">TemplateView</code> (<a href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/base/#templateview" target="_blank">documentação</a>) para apenas mostrar uma página, da seguinte forma:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
</pre></td>
<td class="code"><pre><span class="k">class</span> <span class="nc">IndexTemplateView</span><span class="p">(</span><span class="n">TemplateView</span><span class="p">):</span>
  <span class="n">template_name</span> <span class="o">=</span> <span class="s">"index.html"</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>E a configuração de rotas fica assim:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">helloworld.views</span> <span class="kn">import</span> <span class="n">IndexTemplateView</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">IndexTemplateView</span><span class="p">.</span><span class="n">as_view</span><span class="p">()),</span>
<span class="p">]</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<h3 id="listview"><code class="highlighter-rouge">ListView</code></h3>

<p>Já para o segundo caso, de <strong>listagem de funcionários</strong>, podemos utilizar a <code class="highlighter-rouge">ListView</code> (<a href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-display/#listview" target="_blank">documentação</a>). Nela, nós configuramos o <em>Model</em> que deve ser buscado (<code class="highlighter-rouge">Funcionario</code> no nosso caso), e ela automaticamente faz a busca por todos os registros presentes no banco de dados da entidade informada.</p>

<p>Por exemplo, a seguinte <em>View</em>:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django.views.generic.list</span> <span class="kn">import</span> <span class="n">ListView</span>
<span class="kn">from</span> <span class="nn">helloworld.models</span> <span class="kn">import</span> <span class="n">Funcionario</span>

<span class="k">class</span> <span class="nc">FuncionarioListView</span><span class="p">(</span><span class="n">ListView</span><span class="p">):</span>
  <span class="n">template_name</span> <span class="o">=</span> <span class="s">"website/lista.html"</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">Funcionario</span>
  <span class="n">context_object_name</span> <span class="o">=</span> <span class="s">"funcionarios"</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Com essa configuração:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">helloworld.views</span> <span class="kn">import</span> <span class="n">FuncionarioListView</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'funcionarios/'</span><span class="p">,</span> <span class="n">FuncionarioListView</span><span class="p">.</span><span class="n">as_view</span><span class="p">()),</span>
<span class="p">]</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Resulta em uma página <strong>lista.html</strong> contendo um objeto chamado <strong>"funcionarios"</strong> contendo todos os Funcionários disponível para iteração.</p>

<p><strong>Dica</strong>: <em>Eu geralmente coloco o nome da View como sendo o Model com a CBV base. Por exemplo: se eu fosse criar uma view que vai listar todos os Cursos cadastrados, eu daria o nome de <code class="highlighter-rouge">CursoListView</code> (Model = &lt;Curso&gt;, CBV = &lt;ListView&gt;)</em>.</p>

<h3 id="updateview"><code class="highlighter-rouge">UpdateView</code></h3>

<p>Já para <strong>aualização de usuários</strong> podemos utilizar a <code class="highlighter-rouge">UpdateView</code> (<a href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-editing/#updateview" target="_blank">documentação</a>). Com ela, setamos (no mínimo) qual o <em>Model</em>, quais campos e qual o nome do template, e com isso temos um formulário para atualização do modelo em questão.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django.views.generic.edit</span> <span class="kn">import</span> <span class="n">UpdateView</span>
<span class="kn">from</span> <span class="nn">helloworld.models</span> <span class="kn">import</span> <span class="n">Funcionario</span>

<span class="k">class</span> <span class="nc">FuncionarioUpdateView</span><span class="p">(</span><span class="n">UpdateView</span><span class="p">):</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s">"atualiza.html"</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Funcionario</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s">'nome'</span><span class="p">,</span>
      <span class="s">'sobrenome'</span> <span class="p">,</span>
      <span class="s">'cpf'</span><span class="p">,</span>
      <span class="s">'tempo_de_servico'</span><span class="p">,</span>
      <span class="s">'remuneracao'</span>
    <span class="p">]</span>    
</pre></td>
</tr></tbody></table></code></pre></figure>

<p><strong>Dica:</strong> <em>Ao invés de todos os campos em <code class="highlighter-rouge">fields</code> em formato de lista de strings, podemos utilizar <code class="highlighter-rouge">fields = '__all__'</code> que o Django irá buscar todos os campos para você!</em></p>

<p><strong><em>Mas e de onde o Django vai pegar o <code class="highlighter-rouge">id</code> do objeto a ser buscado?</em></strong></p>

<p>O Django precisa ser informado do <code class="highlighter-rouge">id</code> ou <code class="highlighter-rouge">slug</code> para poder buscar o objeto correto a ser atualizado.</p>

<p>Podemos fazer isso de <strong>duas formas</strong>.</p>

<p><strong>Primeiro</strong>, na configuração de rotas (<em>urls.py</em>), dessa forma:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">helloworld.views</span> <span class="kn">import</span> <span class="n">FuncionarioUpdateView</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Utilizando o {id} para buscar o objeto
</span>    <span class="n">path</span><span class="p">(</span><span class="s">'funcionario/&lt;id&gt;'</span><span class="p">,</span> <span class="n">FuncionarioUpdateView</span><span class="p">.</span><span class="n">as_view</span><span class="p">()),</span>

    <span class="c1"># Utilizando o {slug} para buscar o objeto
</span>    <span class="n">path</span><span class="p">(</span><span class="s">'funcionario/&lt;slug&gt;'</span><span class="p">,</span> <span class="n">FuncionarioUpdateView</span><span class="p">.</span><span class="n">as_view</span><span class="p">()),</span>
<span class="p">]</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p><strong><em>Mas e o que é slug?</em></strong></p>

<p><em>Slug</em> é uma forma de gerar URLs mais legíveis a partir de dados já existentes.</p>

<p>Exemplo: podemos criar um campo <em>slug</em> utilizando o campo <code class="highlighter-rouge">nome</code> do funcionário. Dessa forma, as URLs ficariam assim:</p>

<ul>
  <li><strong>/funcionario/vinicius-ramos</strong></li>
</ul>

<p>e não assim (utilizando o <strong>id</strong> na URL):</p>

<ul>
  <li><strong>/funcionario/175</strong></li>
</ul>

<p>No campo <em>slug</em>, <strong>todos os caracteres</strong> são transformados em minúsculos e os espaços são transformados em hífens.</p>

<p>A <strong>segunda forma</strong> de buscar o objeto que estará disponível na tela de atualização é utilizando (ou <strong>sobrescrevendo</strong>) o método <code class="highlighter-rouge">get_object()</code> da classe pai <code class="highlighter-rouge">UpdateView</code>.</p>

<p>A documentação desse método traz (traduzido):</p>

<blockquote>
  <p>“Retorna o objeto que a View irá mostrar. Requer <code class="highlighter-rouge">self.queryset</code> e um argumento <code class="highlighter-rouge">pk</code> ou <code class="highlighter-rouge">slug</code> no URLConf. Subclasses podem sobrescrever esse método e retornar qualquer objeto.”</p>
</blockquote>

<p>Ou seja, o Django nos dá total liberdade de utilizarmos a <strong>convenção</strong> (parâmetros passados pela <em>URLConf</em>) ou a <strong>configuração</strong> (sobrescrevendo o método <code class="highlighter-rouge">get_object()</code>).</p>

<p>Basicamente, o método <code class="highlighter-rouge">get_object()</code> deve pegar o <code class="highlighter-rouge">id</code> ou <code class="highlighter-rouge">slug</code> da url e realizar a busca no banco de dados até encontrar aquele <code class="highlighter-rouge">id</code>:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django.views.generic.edit</span> <span class="kn">import</span> <span class="n">UpdateView</span>
<span class="kn">from</span> <span class="nn">helloworld.models</span> <span class="kn">import</span> <span class="n">Funcionario</span>

<span class="k">class</span> <span class="nc">FuncionarioUpdateView</span><span class="p">(</span><span class="n">UpdateView</span><span class="p">):</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s">"atualiza.html"</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Funcionario</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="s">'__all__'</span>
    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s">'funcionario'</span>

    <span class="k">def</span> <span class="nf">get_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
      <span class="n">funcionario</span> <span class="o">=</span> <span class="bp">None</span>

      <span class="c1"># Se você utilizar o debug, verá que os 
</span>      <span class="c1"># campos {pk} e {slug} estão presente em self.kwargs
</span>      <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">kwargs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">pk_url_kwarg</span><span class="p">)</span>
      <span class="n">slug</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">kwargs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">slug_url_kwarg</span><span class="p">)</span>

      <span class="k">if</span> <span class="nb">id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># Busca o funcionario apartir do id
</span>        <span class="n">funcionario</span> <span class="o">=</span> <span class="n">Funcionario</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">).</span><span class="n">first</span><span class="p">()</span>

      <span class="k">elif</span> <span class="n">slug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>        
        <span class="c1"># Pega o campo slug do Model
</span>        <span class="n">campo_slug</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">get_slug_field</span><span class="p">()</span>

        <span class="c1"># Busca o funcionario apartir do slug
</span>        <span class="n">funcionario</span> <span class="o">=</span> <span class="n">Funcionario</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">filter</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">campo_slug</span><span class="p">:</span> <span class="n">slug</span><span class="p">}).</span><span class="n">first</span><span class="p">()</span>

      <span class="c1"># Retorna o objeto encontrado
</span>      <span class="k">return</span> <span class="n">funcionario</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Dessa forma, os dados do funcionário de <code class="highlighter-rouge">id</code> ou <code class="highlighter-rouge">slug</code> igual ao que foi passado na URL estarão disponíveis para visualização no <em>template</em> <code class="highlighter-rouge">atualiza.html</code> utilizando o objeto <code class="highlighter-rouge">funcionario</code>!</p>

<p><em>No caso geral, eu prefiro utilizar a convenção (configuração no <strong>URLConf</strong>)</em>.</p>

<h3 id="deleteview"><code class="highlighter-rouge">DeleteView</code></h3>

<p>Para deletar funcionários, utilizamos a <code class="highlighter-rouge">DeleteView</code> (<a href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-editing/#deleteview" target="_blank">documentação</a>).</p>

<p>Sua configuração é similar à <code class="highlighter-rouge">UpdateView</code>: nós devemos informar via URLConf ou <code class="highlighter-rouge">get_object()</code> qual o objeto que queremos excluir.</p>

<p>Precisamos configurar:</p>

<ul>
  <li>O <em>template</em> que será renderizado.</li>
  <li>O <em>model</em> associado à essa <em>view</em>.</li>
  <li>O nome do objeto que estará disponível no <em>template</em> (para confirmar ao usuário, por exemplo, o nome do funcionário que será excluído).</li>
  <li>A URL de retorno, caso haja sucesso na deleção do Funcionário.</li>
</ul>

<p>Com isso, a <em>view</em> pode ser codificada da seguinte forma:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td>
<td class="code"><pre><span class="k">class</span> <span class="nc">FuncionarioDeleteView</span><span class="p">(</span><span class="n">DeleteView</span><span class="p">):</span>
  <span class="n">template_name</span> <span class="o">=</span> <span class="s">"website/exclui.html"</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">Funcionario</span>
  <span class="n">context_object_name</span> <span class="o">=</span> <span class="s">'funcionario'</span>
  <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s">"website:lista_funcionarios"</span><span class="p">)</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Assim como na <code class="highlighter-rouge">UpdateView</code>, fazemos a configuração do <code class="highlighter-rouge">id</code> a ser buscado no <strong>URLConf</strong>, da seguinte forma:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
</pre></td>
<td class="code"><pre><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'funcionario/excluir/&lt;pk&gt;'</span><span class="p">,</span> <span class="n">FuncionarioDeleteView</span><span class="p">.</span><span class="n">as_view</span><span class="p">()),</span>
<span class="p">]</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Assim, precisamos apenas fazer um <em>template</em> de confirmação da exclusão do funcionário.</p>

<p>Podemos fazer da seguinte forma:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td>
<td class="code"><pre><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>    
    {% csrf_token %}

    Você tem certeza que quer excluir o funcionário <span class="nt">&lt;b&gt;</span>{{ funcionario.nome }}<span class="nt">&lt;/b&gt;</span>? <span class="nt">&lt;br&gt;&lt;br&gt;</span>

    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"{% url 'lista_funcionarios' %}"</span><span class="nt">&gt;</span>Cancelar<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;button&gt;</span>Excluir<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Algumas colocações:</p>

<ul>
  <li>Se lembra do atributo <code class="highlighter-rouge">context_object_name</code>? Olha ele ali presente na quarta linha!</li>
  <li>A <em>tag</em> do Django <code class="highlighter-rouge">{% csrf_token %}</code> é obrigatório em todos os <em>forms</em> pois está relacionado à proteção que o Django provê ao <strong>CSRF</strong> - <em>Cross Site Request Forgery</em> (tipo de ataque malicioso - <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)" target="_blank">saiba mais aqui</a>).</li>
  <li>Não se preocupe com a sintaxe do <em>template</em> veremos mais sobre ele no <strong>próximo post</strong>!</li>
</ul>

<h3 id="createview"><code class="highlighter-rouge">CreateView</code></h3>

<p>Essa <em>view</em>, de criação, é bem simples!</p>

<p>Precisamos apenas dizer para o Django o <em>model</em>, o nome do <em>template</em>, a classe do formulário (vamos tratar mais sobre <em>Forms</em> ali embaixo) e a URL de retorno, caso o haja sucesso na inclusão do Funcionário.</p>

<p>Podemos fazer isso dessa forma:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="kn">import</span> <span class="n">CreateView</span>

<span class="k">class</span> <span class="nc">FuncionarioCreateView</span><span class="p">(</span><span class="n">CreateView</span><span class="p">):</span>
  <span class="n">template_name</span> <span class="o">=</span> <span class="s">"website/cria.html"</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">Funcionario</span>
  <span class="n">form_class</span> <span class="o">=</span> <span class="n">InsereFuncionarioForm</span>
  <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s">"website:lista_funcionarios"</span><span class="p">)</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p><em><code class="highlighter-rouge">reverse_lazy()</code> traduz a View em URL. No nosso caso, queremos que quando haja a inclusão do Funcionário, sejamos redirecionados para a página de listagem, para podermos conferir que o Funcionário foi realmente adicionado.</em></p>

<p>E a configuração da rota no arquivo <em>urls.py</em>:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">helloworld.views</span> <span class="kn">import</span> <span class="n">FuncionarioCreateView</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'funcionario/cadastrar/'</span><span class="p">,</span> <span class="n">FuncionarioCreateView</span><span class="p">.</span><span class="n">as_view</span><span class="p">()),</span>
<span class="p">]</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Com isso, estará disponível no <em>template</em> configurado (<code class="highlighter-rouge">website/cria.html</code>, no nosso caso), um objeto <code class="highlighter-rouge">form</code> contendo o formulário para criação do novo funcionário.</p>

<p>Podemos mostrar o formulário de duas formas.</p>

<p>A <strong>primeira</strong>, mostra o formulário inteiro <strong>cru</strong>, isto é, sem formatação e da forma como o Django nos entrega. Podemos mostrá-lo no nosso template da seguinte forma:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td>
<td class="code"><pre><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  {% csrf_token %}

  {{ form }}

  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Cadastrar<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Uma observação: apesar de ser um <code class="highlighter-rouge">Form</code>, sua renderização não contém as <em>tags</em> <code class="highlighter-rouge">&lt;form&gt;&lt;/form&gt;</code> - cabendo a nós incluí-los no <em>template</em>.</p>

<p>Já a <strong>segunda</strong>, é mais trabalhosa, pois temos que renderizar campo a campo no <em>template</em>. Porém, nos dá um nível maior de customização.</p>

<p>Podemos renderizar cada campo do <em>form</em> dessa forma:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td>
<td class="code"><pre><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  {% csrf_token %}

  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"{{ form.nome.id_for_label }}"</span><span class="nt">&gt;</span>Nome<span class="nt">&lt;/label&gt;</span>
  {{ form.nome }}

  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"{{ form.sobrenome.id_for_label }}"</span><span class="nt">&gt;</span>Sobrenome<span class="nt">&lt;/label&gt;</span>
  {{ form.sobrenome }}

  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"{{ form.cpf.id_for_label }}"</span><span class="nt">&gt;</span>CPF<span class="nt">&lt;/label&gt;</span>
  {{ form.cpf }}

  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"{{ form.tempo_de_servico.id_for_label }}"</span><span class="nt">&gt;</span>Tempo de Serviço<span class="nt">&lt;/label&gt;</span>
  {{ form.tempo_de_servico }}

  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"{{ form.remuneracao.id_for_label }}"</span><span class="nt">&gt;</span>Remuneração<span class="nt">&lt;/label&gt;</span>
  {{ form.remuneracao }}

  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Cadastrar<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Dessa forma:</p>

<ul>
  <li>
<code class="highlighter-rouge">{{ form.campo.id_for_label }}</code> traz o <code class="highlighter-rouge">id</code> da tag <code class="highlighter-rouge">&lt;input ...&gt;</code> para adicionar à <em>tag</em> <code class="highlighter-rouge">&lt;label&gt;&lt;/label&gt;</code>.</li>
  <li>Utilizamos o <code class="highlighter-rouge">{{ form.campo }}</code> para renderizar um campo do formulário, e não ele inteiro.</li>
</ul>

<p><em>Antes de continuarmos, vamos respirar um pouco… <strong>Encha sua xícara de café</strong> que ainda tem muita coisa!</em> <img class="emoji" title=":coffee:" alt=":coffee:" src="https://github.githubassets.com/images/icons/emoji/unicode/2615.png" height="20" width="20"></p>

<p>Enquanto isso, já aproveita e se <strong>inscreve aqui embaixo</strong> pra ficar sabendo em primeira mão do lançamento do nosso conteúdo!</p>

<div class="email-signup" data-aos="fade-up" data-aos-easing="ease-out-quart" data-aos-duration="650">
	<div class="row">
		<div class="col-xs-12">
			<div class="signup-body">
				<span class="greeting">Olá <img class="emoji" title=":wave:" alt=":wave:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f44b.png" height="20" width="20"> Está gostando do artigo?</span>
				<span class="signup-text">Então cadastre o seu email para <span class="underline">receber gratuitamente</span> mais conteúdos como este!</span>
		        <!-- Include MailChimp email form with input and submit button -->
<!-- Parameters: Quero ser um PYTHONISTA = button label  -->

<form action="https://pythonacademy.us12.list-manage.com/subscribe/post?u=d818a1dcab21e0bb6fbe4a39b&amp;id=11b4623db6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" autocomplete="off" novalidate="">
    <div id="mc_embed_signup_scroll" class="container-fluid">        
        <div class="row no-gutters">
            <div class="col-xs-3">
                <input id="mce-NAME" type="text" value="" name="NAME" class="signup-input name" placeholder="Nome" required="">
            </div>
            
            <div class="col-xs-5">                
                <input id="mce-EMAIL" type="email" value="" name="EMAIL" class="signup-input email" placeholder="Email" required="">                
            </div>

            <div class="col-xs-4">
                <button id="mc-embedded-subscribe" type="submit" name="subscribe" class="btn">
                    <!--<i class="fa fa-paper-plane-o fa-fw" aria-hidden="true"></i>-->
                    <!--<span>Enviar</span>-->
                    <i class="fa fa-mail-forward visible-xs" aria-hidden="true"></i>
                    <span class="hidden-xs"><img class="emoji" title=":rocket:" alt=":rocket:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f680.png" height="20" width="20"> Quero ser um PYTHONISTA</span>
                </button>        
            </div>
        </div>
    </div>	

    <div id="mce-responses" class="clear">
        <div class="response" id="mce-error-response" style="display:none"></div>
        <div class="response" id="mce-success-response" style="display:none"></div>
    </div>            
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_d818a1dcab21e0bb6fbe4a39b_11b4623db6" tabindex="-1" value=""></div>
</form>
		    </div>
		</div>
	</div>      
</div>

<p>Agora vamos detalhar mais a classe <code class="highlighter-rouge">Form</code>, abordada aqui em cima!</p>

<h2 id="forms">Forms</h2>

<p>O tratamento de formulários é uma tarefa que pode ser <strong>bem complexa</strong>.</p>

<p>Considere um formulário com diversos campos e diversas regras de validação: seu tratamento não é mais um processo simples.</p>

<p>Os <em>Forms</em> do Django são formas de descrever os elementos <code class="highlighter-rouge">&lt;form&gt;...&lt;/form&gt;</code> das páginas HTML, simplificando e automatizando o processo de validação.</p>

<p>O Django trata três partes distintas dos formulários:</p>

<ul>
  <li>Preparação dos dados tornando-os prontos para renderização</li>
  <li>Criação de formulários HTML para os dados</li>
  <li>Recepção e processamento dos formulários enviados ao servidor</li>
</ul>

<p>Basicamente, queremos uma forma de renderizar em nosso <em>template</em> o código HTML:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td>
<td class="code"><pre><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/insere-funcionario/"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"nome"</span><span class="nt">&gt;</span>Your name: <span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"nome"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"nome"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Enviar"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Que, ao ser submetido ao servidor, tenha seus campos de entrada validados e inseridos no banco de dados.</p>

<p>No centro desse sistema de formulários do Django está a classe <code class="highlighter-rouge">Form</code>.</p>

<p>Nela, nós deescrevemos os campos que estarão disponíveis no formulário HTML e os métodos de validação.</p>

<p>Para o formulário acima, podemos descrevê-lo da seguinte forma.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>

<span class="k">class</span> <span class="nc">InsereFuncionarioForm</span><span class="p">(</span><span class="n">forms</span><span class="p">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">nome</span> <span class="o">=</span> <span class="n">forms</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">'Nome do Funcionário'</span><span class="p">,</span> 
        <span class="n">max_length</span><span class="o">=</span><span class="mi">100</span>
    <span class="p">)</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Nesse formulário:</p>

<ul>
  <li>Utilizamos a classe <code class="highlighter-rouge">forms.CharField</code> para descrever um campo de texto.</li>
  <li>O parâmetro <code class="highlighter-rouge">label</code> descreve um rótulo para esse campo.</li>
  <li>
<code class="highlighter-rouge">max_length</code> decreve o tamanho máximo que esse <em>input</em> pode receber (100 caracteres, no caso).</li>
</ul>

<p><em>Veja os diversos tipos de campos disponíveis <a href="https://docs.djangoproject.com/pt-br/2.0/ref/forms/fields/" target="_blank">acessando aqui</a></em></p>

<p>A classe <code class="highlighter-rouge">forms.Form</code> possui um método muito importante, chamado <code class="highlighter-rouge">is_valid()</code>.</p>

<p>Quando um formulário é submetido ao servidor, esse é um dos métodos que irá realizar a validação dos campos do formulário.</p>

<p>Se tudo estiver <strong>OK</strong>, ele colocará os dados do formulário no atributo <code class="highlighter-rouge">cleaned_data</code> (que pode ser acessado por você posteriormente para pegar alguma informação - como o nome que foi inserido pelo usuário no campo <code class="highlighter-rouge">&lt;input name='nome'&gt;</code>).</p>

<p>Como o processo de validaçõ do Django é bem complexo e para não prolongar muito o <em>post</em>, <a href="https://docs.djangoproject.com/en/2.0/ref/forms/validation/" target="_blank">acesse a documentação aqui</a> para saber mais.</p>

<p>Vamos ver agora um exemplo mais complexo com um formulário de inserção de um Funcionário com todos os campos.</p>

<p>Vamos começar criando o arquivo <code class="highlighter-rouge">forms.py</code> dentro do app <em>website</em> do nosso projeto usando como base os campos do <em>model</em> <code class="highlighter-rouge">Funcionario</code>.</p>

<p>Se você não se lembra dos campos - que descrevemos no <a href="https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-model" target="_blank">post passado sobre a camada <em>Model</em></a> - aqui vão eles:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Funcionario</span><span class="p">(</span><span class="n">models</span><span class="p">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="n">nome</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span>
    <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span>
    <span class="n">null</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">blank</span><span class="o">=</span><span class="bp">False</span>
  <span class="p">)</span>

  <span class="n">sobrenome</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span>
    <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span>
    <span class="n">null</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">blank</span><span class="o">=</span><span class="bp">False</span>
  <span class="p">)</span>

  <span class="n">cpf</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span>
    <span class="n">max_length</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
    <span class="n">null</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">blank</span><span class="o">=</span><span class="bp">False</span>
  <span class="p">)</span>

  <span class="n">tempo_de_servico</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">IntegerField</span><span class="p">(</span>
    <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">null</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">blank</span><span class="o">=</span><span class="bp">False</span>
  <span class="p">)</span>

  <span class="n">remuneracao</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">DecimalField</span><span class="p">(</span>
    <span class="n">max_digits</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">null</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">blank</span><span class="o">=</span><span class="bp">False</span>
  <span class="p">)</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Dessa forma, e consultando a <a href="https://docs.djangoproject.com/pt-br/2.0/ref/forms/fields/" target="_blank">documentação</a> dos possíveis campos do nosso formulário, nós podemos descrever um formulário de inserção da seguinte forma:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>

<span class="k">class</span> <span class="nc">InsereFuncionarioForm</span><span class="p">(</span><span class="n">forms</span><span class="p">.</span><span class="n">Form</span><span class="p">)</span>

    <span class="n">nome</span> <span class="o">=</span> <span class="n">forms</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span>
    <span class="p">)</span>

    <span class="n">sobrenome</span> <span class="o">=</span> <span class="n">forms</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span>
    <span class="p">)</span>

    <span class="n">cpf</span> <span class="o">=</span> <span class="n">forms</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">14</span>
    <span class="p">)</span>

    <span class="n">tempo_de_servico</span> <span class="o">=</span> <span class="n">forms</span><span class="p">.</span><span class="n">IntegerField</span><span class="p">(</span>
        <span class="n">required</span><span class="o">=</span><span class="bp">True</span>
    <span class="p">)</span>

    <span class="n">remuneracao</span> <span class="o">=</span> <span class="n">forms</span><span class="p">.</span><span class="n">DecimalField</span><span class="p">(</span>

    <span class="p">)</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p><em>Affff, o Model e o Form são quase iguais… Terei que reescrever os campos toda vez? <img class="emoji" title=":scream:" alt=":scream:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f631.png" height="20" width="20"></em></p>

<p><strong><em>Claro que não, jovem!</em></strong> <em>Pra isso o Django criou o incrível <code class="highlighter-rouge">ModelForm</code>!!!</em> <img class="emoji" title=":wink:" alt=":wink:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f609.png" height="20" width="20"></p>

<p>Com o <code class="highlighter-rouge">ModelForm</code> nós descrevemos os campos que queremos (atributo <code class="highlighter-rouge">fields</code>) e/ou os campos que não queremos (atributo <code class="highlighter-rouge">exclude</code>) no formulário em forma de lista.</p>

<p>Para isso, utilizamos a classe interna <code class="highlighter-rouge">Meta</code> para incluirmos esses metadados na nossa classe.</p>

<p>Metadado (no caso do <em>Model</em> e do <code class="highlighter-rouge">Form</code>) é tudo aquilo que não será transformado em campo, como <code class="highlighter-rouge">model</code>, <code class="highlighter-rouge">fields</code>, <code class="highlighter-rouge">ordering</code> etc (<a href="https://docs.djangoproject.com/en/2.0/topics/db/models/#meta-options" target="_blank">mais sobre <code class="highlighter-rouge">Meta</code> <em>options</em></a>)</p>

<p>Nosso <code class="highlighter-rouge">ModelForm</code>, pode ser descrito da seguinte forma:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>

<span class="k">class</span> <span class="nc">InsereFuncionarioForm</span><span class="p">(</span><span class="n">forms</span><span class="p">.</span><span class="n">ModelForm</span><span class="p">):</span>
  <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="c1"># Modelo base
</span>    <span class="n">model</span> <span class="o">=</span> <span class="n">Funcionario</span>

    <span class="c1"># Campos que estarão no form
</span>    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s">'nome'</span><span class="p">,</span>
      <span class="s">'sobrenome'</span><span class="p">,</span>
      <span class="s">'cpf'</span><span class="p">,</span>
      <span class="s">'remuneracao'</span>
    <span class="p">]</span>

    <span class="c1"># Campos que não estarão no form    
</span>    <span class="n">exclude</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s">'tempo_de_servico'</span>
    <span class="p">]</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Podemos utilizar apenas o campo <code class="highlighter-rouge">fields</code>, apenas o campo <code class="highlighter-rouge">exclude</code> ou os dois juntos.</p>

<p>Mesmo utilizando os atributos <code class="highlighter-rouge">fields</code> e <code class="highlighter-rouge">exclude</code>, ainda podemos adicionar outros campos, independente dos campos do <em>Model</em>.</p>

<p>O resultado será um formulário com todos os campos presentes no <code class="highlighter-rouge">fields</code>, menos os campos do <code class="highlighter-rouge">exclude</code> mais os outros campos que adicionarmos.</p>

<p>Ficou confuso? Então vamos ver o exemplo:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>

<span class="k">class</span> <span class="nc">InsereFuncionarioForm</span><span class="p">(</span><span class="n">forms</span><span class="p">.</span><span class="n">ModelForm</span><span class="p">)</span>

  <span class="n">chefe</span> <span class="o">=</span> <span class="n">forms</span><span class="p">.</span><span class="n">BooleanField</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s">'Chefe?'</span><span class="p">,</span>
    <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
  <span class="p">)</span>

  <span class="n">biografia</span> <span class="o">=</span> <span class="n">forms</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s">'Biografia'</span><span class="p">,</span>
    <span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">widget</span><span class="o">=</span><span class="n">forms</span><span class="p">.</span><span class="n">TextArea</span>
  <span class="p">)</span>

  <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="c1"># Modelo base
</span>    <span class="n">model</span> <span class="o">=</span> <span class="n">Funcionario</span>

    <span class="c1"># Campos que estarão no form
</span>    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">'nome'</span><span class="p">,</span>
        <span class="s">'sobrenome'</span><span class="p">,</span>
        <span class="s">'cpf'</span><span class="p">,</span>
        <span class="s">'remuneracao'</span>
    <span class="p">]</span>

    <span class="c1"># Campos que não estarão no form    
</span>    <span class="n">exclude</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s">'tempo_de_servico'</span>
    <span class="p">]</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Isso vai gerar um formulário com:</p>

<ul>
  <li>Todos os campos contidos em <code class="highlighter-rouge">fields</code> menos os campos contidos em <code class="highlighter-rouge">exclude</code>
</li>
  <li>O campo <code class="highlighter-rouge">forms.BooleanField</code>, renderizado como um <em>checkbox</em> (<code class="highlighter-rouge">&lt;input type='checkbox' name='chefe' ...&gt;</code>)</li>
  <li>Uma área de texto (<code class="highlighter-rouge">&lt;textarea name='biografia' ...&gt;&lt;/textarea&gt;</code>)</li>
</ul>

<p>Assim como é possível definir atributos nos modelos, os campos do formulário também são customizáveis.</p>

<p>Veja que o campo <code class="highlighter-rouge">biografia</code> é do tipo <code class="highlighter-rouge">CharField</code>, portanto deveria ser renderizado como um campo <code class="highlighter-rouge">&lt;input type='text' ...&gt;'</code>.</p>

<p>Contudo, eu modifiquei o campo setando o atributo <code class="highlighter-rouge">widget</code> com <code class="highlighter-rouge">forms.TextArea</code>.</p>

<p>Assim, ele não mais será um simples <em>input</em>, mas será renderizado como um <code class="highlighter-rouge">&lt;textarea&gt;&lt;/textarea&gt;</code> no nosso <em>template</em>!</p>

<h2 id="middlewares"><em>Middlewares</em></h2>

<p><em>Middlewares</em> são trechos de códigos que podem ser executados antes ou depois do processamento de requisições/respostas pelo Django.</p>

<p>É uma forma que os desenvolvedores, nós, temos para alterar como o Django processa algum dado de entrada ou de saída.</p>

<p>Se você olhar no arquivo <code class="highlighter-rouge">settings.py</code>, nós temos a lista <code class="highlighter-rouge">MIDDLEWARE</code> com diversos <em>middlewares</em> pré-configurados:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td>
<td class="code"><pre><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">'django.middleware.security.SecurityMiddleware'</span><span class="p">,</span>
    <span class="s">'django.contrib.sessions.middleware.SessionMiddleware'</span><span class="p">,</span>
    <span class="s">'django.middleware.common.CommonMiddleware'</span><span class="p">,</span>
    <span class="s">'django.middleware.csrf.CsrfViewMiddleware'</span><span class="p">,</span>
    <span class="s">'django.contrib.auth.middleware.AuthenticationMiddleware'</span><span class="p">,</span>
    <span class="s">'django.contrib.messages.middleware.MessageMiddleware'</span><span class="p">,</span>
    <span class="s">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span><span class="p">,</span>
<span class="p">]</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Por exemplo, o <em>middleware</em> <code class="highlighter-rouge">AuthenticationMiddleware</code> é reponsável por adicionar a variável <code class="highlighter-rouge">user</code> a todas as requisições.</p>

<p>Dessa forma, você pode, por exemplo, mostrar o usuário logado no seu <em>template</em>:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
</pre></td>
<td class="code"><pre><span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"{% url 'profile' id=user.id %}"</span><span class="nt">&gt;</span>Olá, {{ user.email }}<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/li&gt;</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Vamos ver agora como podemos criar o nosso próprio <em>middleware</em>.</p>

<p>Um <em>middleware</em> é um método <em>callable</em> (que tem uma implementação do método <code class="highlighter-rouge">__call__()</code>) que recebe uma <strong>requisição</strong> e retorna uma <strong>resposta</strong>, assim como uma <em>View</em>, e pode ser escrito como função ou como Classe.</p>

<p>Um exemplo de <em>middleware</em> escrito como função é:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
<td class="code"><pre><span class="k">def</span> <span class="nf">middleware_simples</span><span class="p">(</span><span class="n">get_response</span><span class="p">):</span>
    <span class="c1"># Código de inicialização do Middleware
</span>
    <span class="k">def</span> <span class="nf">middleware</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
        <span class="c1"># Código a ser executado para cada requisição 
</span>        <span class="c1"># antes da View, e outros middlewares, serem executada
</span>        
        <span class="n">response</span> <span class="o">=</span> <span class="n">get_response</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

        <span class="c1"># Código a ser executado para cada requisição/resposta
</span>        <span class="c1"># após a execução da View que irá processar 
</span>        
        <span class="k">return</span> <span class="n">response</span>

    <span class="k">return</span> <span class="n">middleware</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>E como Classe:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
<td class="code"><pre><span class="k">class</span> <span class="nc">MiddlewareSimples</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_response</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">get_response</span> <span class="o">=</span> <span class="n">get_response</span>
        <span class="c1"># Código de inicialização do Middleware
</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="c1"># Código a ser executado para cada requisição 
</span>        <span class="c1"># antes da View, e outros middlewares, serem executada
</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

        <span class="c1"># Código a ser executado para cada requisição/resposta
</span>        <span class="c1"># após a execução da View que irá processar 
</span>
        <span class="k">return</span> <span class="n">response</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Como cada <em>Middleware</em> é executado de maneira encadeada, do topo da lista <code class="highlighter-rouge">MIDDLEWARE</code> para o fim, a saída de um é a entrada do próximo.</p>

<p>O método <code class="highlighter-rouge">get_response()</code> pode ser a própria <em>View</em>, caso ela seja a última configurada no <code class="highlighter-rouge">MIDDLEWARE</code> do <code class="highlighter-rouge">settings.py</code>, ou o próximo <em>middleware</em> da cadeia.</p>

<p>Utilizando a construção do <em>middleware</em> via Classe, nós temos três métodos importantes:</p>

<h3 id="process_view"><code class="highlighter-rouge">process_view</code></h3>

<p>Assinatura: <code class="highlighter-rouge">process_view(request, func, args, kwargs)</code></p>

<p>Esse método é chamado logo antes do Django executar a <em>View</em> que vai processar a requisição e possui os seguintes parâmetros:</p>

<ul>
  <li>
<code class="highlighter-rouge">request</code> é o objeto <code class="highlighter-rouge">HttpRequest</code>.</li>
  <li>
<code class="highlighter-rouge">func</code> é a própria <em>view</em> que o Django está para chamar ao final da cadeia de <em>middlewares</em>.</li>
  <li>
<code class="highlighter-rouge">args</code> é a lista de parâmetros posicionais que serão passados à <em>view</em>.</li>
  <li>
<code class="highlighter-rouge">kwargs</code> é o <em>dict</em> contendo os argumentos nomeados (<em>keyword arguments</em>) que serão passados à <em>view</em>.</li>
</ul>

<p>Esse método deve retornar <code class="highlighter-rouge">None</code> ou um objeto <code class="highlighter-rouge">HttpResponse</code>:</p>

<ul>
  <li>Caso retorne <code class="highlighter-rouge">None</code>, o Django entenderá que deve continuar a cadeia de <em>Middlewares</em>.</li>
  <li>Caso retorne <code class="highlighter-rouge">HttpResponse</code>, o Django entenderá que a resposta está pronta para ser enviada de volta e não vai se preocupar em chamar o resto da cadeia de <em>Middlewares</em>, nem a <em>view</em> que iria processar a requisição.</li>
</ul>

<h3 id="process_exception"><code class="highlighter-rouge">process_exception</code></h3>

<p>Assinatura: <code class="highlighter-rouge">process_exception(request, exception)</code></p>

<p>Esse método é chamada quando uma <em>view</em> lança uma exceção e deve retornar ou <code class="highlighter-rouge">None</code> ou <code class="highlighter-rouge">HttpResponse</code>. Caso retorne um objeto <code class="highlighter-rouge">HttpResponse</code>, o Django irá aplicar o <em>middleware</em> de resposta e o de <em>template</em>, retornando a requisição ao <em>browser</em>.</p>

<ul>
  <li>
<code class="highlighter-rouge">request</code> é o objeto <code class="highlighter-rouge">HttpRequest</code>
</li>
  <li>
<code class="highlighter-rouge">exception</code> é a exceção propriamente dita lançada pela <em>view</em> (<code class="highlighter-rouge">Exception</code>).</li>
</ul>

<h3 id="process_template_response"><code class="highlighter-rouge">process_template_response</code></h3>

<p>Assinatura: <code class="highlighter-rouge">process_template_response(request, response)</code></p>

<p>Esse método é chamado logo após a <em>view</em> ter terminado sua execução, caso a resposta tenha uma chamada ao método <code class="highlighter-rouge">render()</code> indicando que a reposta possui um <em>template</em>.</p>

<p>Possui os seguintes parâmetros:</p>

<ul>
  <li>
<code class="highlighter-rouge">request</code> é um objeto <code class="highlighter-rouge">HttpRequest</code>.</li>
  <li>
<code class="highlighter-rouge">response</code> é o objeto <code class="highlighter-rouge">TemplateResponse</code> retornado pela <em>view</em> ou por outro <em>middleware</em>.</li>
</ul>

<p>Agora vamos criar um <em>middleware</em> um pouco mais complexo para exemplificar o que foi dito aqui!</p>

<p>Vamos supor que queremos um <em>middleware</em> que filtre requisições e só processe aquelas que venham de uma determinada lista de IP’s.</p>

<p>O que precisamos fazer é abrir o cabeçalho de todas as requisições que chegam no nosso servidor e verificar se o IP de origem bate com a nossa lista de IP’s.</p>

<p>Para isso, colocamos a lógica no método <code class="highlighter-rouge">process_view</code>, da seguinte forma:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td>
<td class="code"><pre><span class="k">class</span> <span class="nc">FiltraIPMiddleware</span><span class="p">:</span>    

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_response</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">get_response</span> <span class="o">=</span> <span class="n">get_response</span>

  <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>

  <span class="k">def</span> <span class="nf">process_view</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># Lista de IPs autorizados
</span>    <span class="n">ips_autorizados</span> <span class="o">=</span> <span class="p">[</span><span class="s">'127.0.0.1'</span><span class="p">]</span>

    <span class="c1"># IP do usuário
</span>    <span class="n">ip</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">META</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'REMOTE_ADDR'</span><span class="p">)</span>

    <span class="c1"># Verifica se o IP do cliente está na lista de IPs autorizados
</span>    <span class="k">if</span> <span class="n">ip</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ips_autorizados</span><span class="p">:</span>
      <span class="c1"># Se usuário não autorizado &gt; HTTP 403: Não Autorizado
</span>      <span class="k">return</span> <span class="n">HttpResponseForbidden</span><span class="p">(</span><span class="s">"IP não autorizado"</span><span class="p">)</span>

    <span class="c1"># Se for autorizado, não fazemos nada
</span>    <span class="k">return</span> <span class="bp">None</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Depois disso, precisamos registrar nosso <em>middleware</em> no arquivo de configurações <code class="highlighter-rouge">settings.py</code> (na configuração <code class="highlighter-rouge">MIDDLEWARE</code>):</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td>
<td class="code"><pre><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
  <span class="c1"># Middlewares do próprio Django
</span>  <span class="s">'django.middleware.security.SecurityMiddleware'</span><span class="p">,</span>
  <span class="s">'django.contrib.sessions.middleware.SessionMiddleware'</span><span class="p">,</span>
  <span class="s">'django.middleware.common.CommonMiddleware'</span><span class="p">,</span>
  <span class="s">'django.middleware.csrf.CsrfViewMiddleware'</span><span class="p">,</span>
  <span class="s">'django.contrib.auth.middleware.AuthenticationMiddleware'</span><span class="p">,</span>
  <span class="s">'django.contrib.messages.middleware.MessageMiddleware'</span><span class="p">,</span>
  <span class="s">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span><span class="p">,</span>

  <span class="c1"># Nosso Middleware
</span>  <span class="s">'helloworld.middlewares.FiltraIPMiddleware'</span><span class="p">,</span>
<span class="p">]</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Agora, podemos testar seu funcionamento alterando a lista <code class="highlighter-rouge">ips_autorizados</code>:</p>

<ul>
  <li>Coloque <code class="highlighter-rouge">ips_autorizados = ['127.0.0.1']</code> e tente acessar alguma URL da nossa aplicação: devemos conseguir acessar normalmente nossa aplicação, pois como estamos executando o servidor localmente, nosso IP será 127.0.0.1 e, portanto, passaremos no teste.</li>
  <li>Coloque <code class="highlighter-rouge">ips_autorizados = []</code> e tente acessar alguma URL da nossa aplicação: deve aparecer a mensagem de <strong>“IP não autorizado”</strong>, pois nosso IP (127.0.0.1) não está autorizado a  acessar o servidor.</li>
</ul>

<h2 class="no_toc" id="código">Código</h2>

<p>Se quiser fazer o <em>download</em> do código desenvolvido até aqui, <a href="/assets/posts/django-view/helloworld-final.zip" target="_blank">clique aqui para baixá-lo</a>!</p>

<h2 class="no_toc" id="conclusão">Conclusão</h2>

<p>Ufa! Acho melhor parar por aqui… <img class="emoji" title=":tired_face:" alt=":tired_face:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f62b.png" height="20" width="20"></p>

<p>Vimos vários conceitos sobre os tipos de <em>Views</em> (funções e classes), alguns tipos de CBV (<em>Class Based Views</em>), como mapear suas URL para suas <em>views</em> através do URLConf, como entender o fluxo da sua requisição utilizando o debug da sua IDE, como utilizar os poderosos <code class="highlighter-rouge">Forms</code> do Django, como utilizar <em>middlewares</em> para adicionar camadas extras de processamento às requisições e respostas que chegam e saem da nossa aplicação.</p>

<p>Com certeza ainda tem muita coisa para você descobrir e desvendar! MAs não se esqueça que qualquer dúvida que você tiver no seu processo de aprendizagem, não exite em entrar em contato comigo pelas minhas redes sociais ou pelo <strong><em>box</em> de comentário</strong> aqui embaixo!</p>

<p>Espero ter facilitado seu entendimento sobre a camada <em>View</em> do Django!</p>

<p>No <em>post</em> sobre a Camada <em>Template</em> (<a href="https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-template">que já está disponível aqui</a>) construímos os <em>templates</em> e páginas HTML da nossa aplicação!</p>

<p>Quer levar esse conteúdo para onde for com nosso <strong>ebook GRÁTIS</strong>?</p>

<p>Então aproveita essa chance <img class="emoji" title=":point_down:" alt=":point_down:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f447.png" height="20" width="20"> <img class="emoji" title=":point_down:" alt=":point_down:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f447.png" height="20" width="20"> <img class="emoji" title=":point_down:" alt=":point_down:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f447.png" height="20" width="20"></p>

<div class="ebook-wrapper" data-aos="fade-up" data-aos-easing="ease-out-quart" data-aos-duration="650">
    <div class="ebook">
        <div class="row">
            <div class="col-xs-12 text-center">
                <h2>Ebook GRÁTIS</h2>
            </div>

            <div class="col-lg-5 col-md-5 col-xs-12 text-center">
                <img src="/assets/ebooks/desenvolvimento-web-com-python-e-django/capa.png" alt="Capa Ebook Desenvolvimento Web com Python e Django" data-aos="fade-in" class="ebook-cover">
            </div>
    
            <div class="col-lg-7 col-md-7 col-xs-12">
                <div class="ebook-data pb-0 pt-0" data-aos="fade-in">
                    <h3 class="ebook-title">Desenvolvimento Web com Python e Django</h3>
    
                    <ul class="ebook-description">
                        <li>Veja como modelar sua aplicação</li>
                        <li>Utilize a robusta API de Acesso a Dados do Django</li>
                        <li>Aprenda sobre <i>Class Based Views</i>
</li>
                        <li>Construa <i>Middlewares</i> próprios</li>
                        <li>Desenvolva filtros e <i>tags</i> customizados para criar lindos <i>templates</i>
</li>
                    </ul>
    
                    <div class="link-to-download">                                    
                        <a href="/ebooks/desenvolvimento-web-com-python-e-django/" class="call-to-action yellow">
                            Baixe já!
                        </a>
                    </div>    
                </div>
            </div>
        </div>
    </div>
</div>

<p>Nos vemos!</p>

<p>Bom desenvolvimento! <img class="emoji" title=":wink:" alt=":wink:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f609.png" height="20" width="20"></p>



					<div class="blue-yellow-separator no-repeat"></div>

					<div class="blog-post-footer">
						
						<div class="blog-post-colophon">
							<div class="row">
								<div class="col-xs-12 col-sm-3 text-center">									
									<img src="/assets/authors/vinicius-ramos/avatar.png" width="100%" alt="Autor" class="profile-img">
								</div>

								<div class="col-xs-12 col-sm-9">
									<div class="blog-post-meta">
										<h2>
											<span class="blog-post-by">
												Por Vinícius Ramos
											</span>

											<b>em <time datetime="2018-06-20" pubdate>20/06/2018</time></b>
										</h2>
	
										<p class="short-description">"<i>Porque o Senhor dá a sabedoria, e da sua boca vem a inteligência e o entendimento. - Provérbios 2:6 </i>"</p>

										<p class="author-media-label">Minhas redes:</p>
										
										<ul>
											
											<li><a href="https://www.linkedin.com/in/vinicius-aramos" target="_blank"><i class="fa fa-linkedin-square" style="color: #0072b1;" aria-hidden="true"></i></a></li>
																						
											
											<li><a href="mailto:vinicius.ramos@pythonacademy.com.br"><i class="fa fa-envelope" aria-hidden="true"></i></a></li>
																						
											
											<li><a href="https://github.com/viniciusramos91" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a></li>
											
											
											<li><a href="https://stackoverflow.com/users/6775679/viniciusramos91" target="_blank"><i class="fa fa-stack-overflow" aria-hidden="true"></i></a></li>
											
											
										</ul>
									</div>
								</div>
							</div>				
						</div>
					</div>
				</div>				
			</div>									
		</div>	

		<!-- READ MORE -->	
		<div class="more-posts">
			<section class="container">
				<div class="section-header">
		            <h2 class="black">Continue aprendendo!</h2>
		        </div>

				<div class="row">
					<div id="random_posts"></div>
				</div>	

				<div class="text-center">
	                <a href="/blog/index.html" class="button ripple-out-animation">
	                    ←  Retornar ao Blog
	                </a>
	            </div>		
			</section>		
		</div>

						
			
<div id="comment-box" class="center-block">
    <div class="container">
        <div id="disqus_thread"></div>        
    </div>
</div>

		

		<!-- Affix -->		
		<div class="social-media-affix">
			<h2 class="visible-xs">Gostou do conteúdo? Compartilha aí!</h2>
			<ul>				
				<li>
					<a rel="nofollow" href="javascript:window.open('https://www.facebook.com/sharer/sharer.php?u=https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-view','Compartilhe%20no%20Facebook','width=600,height=400')" class="facebook-item">
						<i class="fa fa-fw fa-facebook"></i>
					</a>
				</li>				
				
				<li>							
					<a rel="nofollow" href="javascript:window.open('https://twitter.com/share?url=https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-view&amp;related=PythonAcademyBR&amp;text=%22A%20Camada%20View%20do%20framework%20de%20desenvolvimento%20web%20Django%20(Python)%22%20por%20Vin%C3%ADcius%20Ramos','Compartilhe%20no%20Twitter','width=600,height=400')" class="twitter-item" target="_blank">
						<i class="fa fa-fw fa-twitter"></i>
					</a>
				</li>

				<li>
					<a rel="nofollow" href="https://api.whatsapp.com/send?text=https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-view" target="_blank" class="whatsapp-item" data-link="https://api.whatsapp.com/send?text=https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-view" data-action="share/whatsapp/share">
						<i class="fa fa-fw fa-whatsapp"></i>
					</a>
				</li>

				<li>
					<a href="https://mail.google.com/mail?view=cm&amp;fs=1&amp;su=A%20Camada%20View%20do%20framework%20de%20desenvolvimento%20web%20Django%20(Python)&amp;body=https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-view&amp;ui=2&amp;tf=1" target="_blank" class="gmail-item">
						<i class="fa fa-fw fa-envelope"></i>
					</a>
				</li>

				
			</ul>
		</div>		

		


<section id="footer-signup">
	<div class="container">
		<div class="row">
			<div class="col-xs-12 text-center">
				<h2 class="bold">Aprenda Python de Verdade!</h2>
				<p class="mb-32">
					Cadastre o seu <span class="bold">melhor email</span> para receber gratuitamente conteúdos exclusivos e muito mais!
				</p>
			</div>
			
			<div class="col-xs-12 col-md-8 col-md-offset-2">
				<!-- Include MailChimp email form with input and submit button -->
<!-- Parameters: Eu quero! = button label  -->

<form action="https://pythonacademy.us12.list-manage.com/subscribe/post?u=d818a1dcab21e0bb6fbe4a39b&amp;id=11b4623db6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" autocomplete="off" novalidate>
    <div id="mc_embed_signup_scroll" class="container-fluid">        
        <div class="row no-gutters">
            <div class="col-xs-3">
                <input id="mce-NAME" type="text" value="" name="NAME" class="signup-input name" placeholder="Nome" required>
            </div>
            
            <div class="col-xs-5">                
                <input id="mce-EMAIL" type="email" value="" name="EMAIL" class="signup-input email" placeholder="Email" required>                
            </div>

            <div class="col-xs-4">
                <button id="mc-embedded-subscribe" type="submit" name="subscribe" class="btn">
                    <!--<i class="fa fa-paper-plane-o fa-fw" aria-hidden="true"></i>-->
                    <!--<span>Enviar</span>-->
                    <i class="fa fa-mail-forward visible-xs" aria-hidden="true"></i>
                    <span class="hidden-xs"><img class="emoji" title=":rocket:" alt=":rocket:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f680.png" height="20" width="20"> Eu quero!</span>
                </button>        
            </div>
        </div>
    </div>	

    <div id="mce-responses" class="clear">
        <div class="response" id="mce-error-response" style="display:none"></div>
        <div class="response" id="mce-success-response" style="display:none"></div>
    </div>            
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_d818a1dcab21e0bb6fbe4a39b_11b4623db6" tabindex="-1" value=""></div>
</form>
			</div>
		</div>
	</div>
</section>

<section id="footer">
	<div class="container">
		<div class="row">
			<div class="col-xs-12 col-sm-4">
				<div class="footer-wrapper">
					<p>Sobre</p>
	
					<ul>					
						<li>
							<a href="/">Início</a>
						</li>

						<li>
							<a href="/sobre">Sobre a Python Academy</a>
						</li>
	
						<li>
							<a href="/zen-of-python"><i>Zen of Python</i></a>
						</li>
					</ul>
				</div>
			</div>

			<div class="col-xs-12 col-sm-4">
				<div class="footer-wrapper">
					<p>Conteúdo</p>
	
					<ul>
						<li>
							<a href="/blog/">Blog</a>
						</li>
						<li>
							<a href="/sliders/">Sliders</a>
						</li>						
					</ul>
				</div>
			</div>

			<div class="col-xs-12 col-sm-4">
				<div class="footer-wrapper">
					<p>Ebooks</p>
	
					<ul>
						<li>
							<a href="/ebooks/desenvolvimento-web-com-python-e-django/">Desenvolvimento Web com Python e Django</a>
						</li>					
					</ul>
				</div>
			</div>
		</div>

		<div class="blue-yellow-separator no-repeat pt-64 pb-64"></div>
		
		<div class="row">
			<div class="col-sm-12 hidden-xs text-center">
				<div class="footer-wrapper">
					<img src="/assets/img/logo.png" alt="Aprenda Computação de Verdade!" class="footer-logo">
	
					<p class="footer-label mt-16">
						Existimos para levar o conhecimento de Python a todos de forma simples e inovadora!
					</p>
	
					<ul class="social-medias">
						<li>
							<a href="https://www.instagram.com/pythonacademybr/" target="_blank">
								<img src="/assets/img/instagram.png" alt="Facebook" data-aos="fade-in" data-aos-delay="0" data-aos-duration="500">
							</a>
						</li>

						<li>
							<a href="https://www.facebook.com/pythonacademy" target="_blank">
								<img src="/assets/img/facebook.png" alt="Facebook" data-aos="fade-in" data-aos-delay="150" data-aos-duration="500">
							</a>
						</li>												
						
						<li>
							<a href="https://www.linkedin.com/company/pythonacademy/" target="_blank">
								<img src="/assets/img/linkedin.png" alt="Medium" data-aos="fade-in" data-aos-delay="300" data-aos-duration="500">
							</a>
						</li>						
					</ul>
				</div>
			</div>
		</div>
	</div>
</section>

<section id="footer-copyright">
	<div class="text-center">
		<p>
			© <b>2021</b> Python Academy <img src="/assets/img/cross.png" alt="Conheça Jesus Cristo!" height="24px" class="ml-16 mr-16 hidden-xs"> <br class="visible-xs">
			<i>"Porque o Senhor dá a <b>sabedoria</b>, e da sua boca vem a <b>inteligência</b> e o <b>entendimento</b>" Pv 2:6</i>
		</p>
	</div>
</section>

<script src="/assets/vendors/bundle.min.js"></script>

<!-- Custom scripts -->

<script src="/assets/js/min/script.min.js"></script>




		<!-- Cookie.js -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.0/js.cookie.min.js"></script>
		
		<!-- Javascript -->		
		<script type="text/javascript">			
			(function($) {
				AOS.init({
					easing: 'ease-out-back',
					duration: 1500
				});

				generateRandomPosts();
			})(jQuery);
			
			
				new Vivus('featured-icon', {
					duration: 80,
					type: 'delayed' // [delayed, sync, oneByOne, script, scenario, scenario-sync]
				});
						

			$('.social-media-affix').affix({
				offset: {
					top: $(".post-banner").height()
				}
			});

			// Generate random posts
			function generateRandomPosts() {
				var counter = 0;	            

				$.getJSON("/blog/posts.json", function(data) {
					var postsCount = data.length;					
					var posts = data;

					var randomIndexUsed = [];	
					var numberOfPosts = 4;

					var divRandomPosts = $("#random_posts");		            

					while (counter < numberOfPosts) {
						var randomIndex = Math.floor(Math.random() * postsCount);
						
						if (randomIndexUsed.indexOf(randomIndex) == "-1") {

							var post = posts[randomIndex];

							// Verify if related post is the same as the shown
							if (post.title != "A Camada View do framework de desenvolvimento web Django (Python)") {
								var postHTML = 
									"<div class='col-lg-3 col-md-6 col-sm-6 col-xs-12'>" +
										"<a href='" + post.href + "' class='card aos-init aos-animate' data-aos='fade-up'>" +
											"<div class='card-frame'>" +
												"<object id='featured-icon-" + counter + " class=featured-icon' type='image/svg+xml' data='/assets/posts/" + post.assets + "/" + post.featured_icon + "' height='175px'></object>" +
											"</div>" + 
											
											"<div class='caption'>" +
												"<h3 class='card-title'>" +
													post.title +
												"</h3>" +
											"</div>" +
										"</div>" +
									"</div>"

								divRandomPosts.append(postHTML);
								randomIndexUsed.push(randomIndex);
								
								counter++;
							}
						}
					}
				});								
			}
			
			// Show signup modal on mouse leave event
			$( document ).ready(function() {
				$("body").bind("mouseleave",function(){
					if(!Cookies.get('pa_popup')) {
	
						// Same as included sticky-newsletter id
						$('#email-modal').modal('show');

						/* Set cookie so this does not repeat */
						Cookies.set('pa_popup', '1', { expires: 1, path: 'https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-view' });
					}
				});		
				
				// Initialize SVG animation on each related posts
				$("#random_posts").find('.card-frame object').each(function(index, element) {
					new Vivus(element, {
						duration: 80,
						type: 'delayed' // [delayed, sync, oneByOne, script, scenario, scenario-sync]
					});
				})
			});

		</script>
		
		<script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us12.list-manage.com","uuid":"d818a1dcab21e0bb6fbe4a39b","lid":"11b4623db6"}) })</script>	

		
			<script type="text/javascript">
				var disqus_config = function () {
					this.page.url = 'https://pythonacademy.com.br/blog/desenvolvimento-web-com-python-e-django-view';     // Replace PAGE_URL with your page's canonical URL variable
					this.page.identifier = '/blog/desenvolvimento-web-com-python-e-django-view';             // Replace PAGE_IDENTIFIER with your page's unique identifier variable
				};
			
				(function() { // DON'T EDIT BELOW THIS LINE
					var d = document, s = d.createElement('script');
					s.src = '//python-academy.disqus.com/embed.js';
					s.setAttribute('data-timestamp', +new Date());
					(d.head || d.body).appendChild(s);
				})();
			</script>
		
			<noscript>Por favor, habilite o Javascript para visualizar os <a href="https://disqus.com/?ref_noscript">comentários.</a>
</noscript>
		
	</body>
</html>

